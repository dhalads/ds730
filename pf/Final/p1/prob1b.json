{"paragraphs":[{"text":"//Problem 1b\n\n/*\nWhen I moved from Wisconsin to Iowa for school, the summers and\nwinters seemed similar but the spring and autumn seemed much more\ntolerable. For this problem, we will be using meteorological seasons:\nWinter - Dec, Jan, Feb\nSpring - Mar, Apr, May\nSummer - Jun, Jul, Aug\nFall - Sep, Oct, Nov\nCompute the average temperature (sum all temperatures in the time\nperiod and divide by the number of readings) for each season for Oshkosh\nand Iowa City. What is the difference in average temperatures for each\nseason for Oshkosh vs Iowa City?\n*/\n\n/*\nYear,Month,Day,TimeCST,TemperatureF,Dew PointF,Humidity,Sea Level PressureIn,VisibilityMPH,Wind Direction,Wind SpeedMPH,Gust SpeedMPH,PrecipitationIn,Events,Conditions,WindDirDegrees\n2000,1,1,12:53 AM,36,30.9,82,29.95,10,SSW,11.5,-,N/A,,Partly Cloudy,200\n2000,1,1,1:53 AM,37,30.9,79,29.96,10,SSW,6.9,-,N/A,,Partly Cloudy,210\n2000,1,1,2:53 AM,36,30,79,29.96,10,SW,5.8,-,N/A,,Partly Cloudy,220\n2000,1,1,3:53 AM,34,28.9,82,29.96,10,Calm,Calm,-,N/A,,Clear,0\n2000,1,1,4:53 AM,28.9,26.1,89,29.97,10,Calm,Calm,-,N/A,,Partly Cloudy,0\n*/\n\nval weatherW = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\",true).load(\"/user/maria_dev/final/Oshkosh/OshkoshWeather.csv\"\n    ).filter($\"TemperatureF\" > -100 ).select(\"Year\", \"Month\", \"Day\", \"TemperatureF\")\n\nval weatherI = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\",true).load(\"/user/maria_dev/final/IowaCity/IowaCityWeather.csv\"\n    ).filter($\"TemperatureF\" > -100 ).select(\"Year\", \"Month\", \"Day\", \"TemperatureF\")\n\nval extraW = weatherW.withColumn(\"Season\", \n    when(col(\"Month\") === 12 || col(\"Month\") === 1 || col(\"Month\") === 2, \"Winter\")\n    .when(col(\"Month\") === 3 || col(\"Month\") === 4 || col(\"Month\") === 5, \"Spring\")\n    .when(col(\"Month\") === 6 || col(\"Month\") === 7 || col(\"Month\") === 8 , \"Summer\")\n    .otherwise(\"Fall\")\n    ).groupBy(\"Season\").agg(avg(\"TemperatureF\").as(\"avgTemp\"))\n\nval extraI = weatherI.withColumn(\"Season\", \n    when(col(\"Month\") === 12 || col(\"Month\") === 1 || col(\"Month\") === 2, \"Winter\")\n    .when(col(\"Month\") === 3 || col(\"Month\") === 4 || col(\"Month\") === 5, \"Spring\")\n    .when(col(\"Month\") === 6 || col(\"Month\") === 7 || col(\"Month\") === 8 , \"Summer\")\n    .otherwise(\"Fall\")\n    ).groupBy(\"Season\").agg(avg(\"TemperatureF\").as(\"avgTemp\"))\n\n\n\n    extraW.show(false)\n    extraI.show(false)\n\nval join1 = extraW.alias(\"a\").join(extraI.alias(\"b\"), \"Season\").withColumn(\"Difference\",\n$\"a.avgTemp\" - $\"b.avgTemp\"\n)\nval join2 = join1.select($\"Season\", $\"a.avgTemp\".alias(\"WAvgTemp\"), $\"b.avgTemp\".alias(\"IAvgTemp\"), $\"Difference\")\njoin2.show(false)\n\n","user":"anonymous","dateUpdated":"2020-12-15T23:25:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"weatherW: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 2 more fields]\nweatherI: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 2 more fields]\nextraW: org.apache.spark.sql.DataFrame = [Season: string, avgTemp: double]\nextraI: org.apache.spark.sql.DataFrame = [Season: string, avgTemp: double]\n+------+-----------------+\n|Season|avgTemp          |\n+------+-----------------+\n|Spring|44.76670739709886|\n|Summer|69.1584675299853 |\n|Fall  |49.41173731871389|\n|Winter|22.86142493745641|\n+------+-----------------+\n\n+------+-----------------+\n|Season|avgTemp          |\n+------+-----------------+\n|Spring|50.20830046861242|\n|Summer|72.55176916393103|\n|Fall  |52.20284364734914|\n|Winter|25.04653471771574|\n+------+-----------------+\n\njoin1: org.apache.spark.sql.DataFrame = [Season: string, avgTemp: double ... 2 more fields]\njoin2: org.apache.spark.sql.DataFrame = [Season: string, WAvgTemp: double ... 2 more fields]\n+------+-----------------+-----------------+-------------------+\n|Season|WAvgTemp         |IAvgTemp         |Difference         |\n+------+-----------------+-----------------+-------------------+\n|Spring|44.76670739709886|50.20830046861242|-5.441593071513559 |\n|Summer|69.1584675299853 |72.55176916393103|-3.3933016339457254|\n|Fall  |49.41173731871389|52.20284364734914|-2.7911063286352515|\n|Winter|22.86142493745641|25.04653471771574|-2.1851097802593316|\n+------+-----------------+-----------------+-------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1608074654213_298547453","id":"20201215-232414_559198111","dateCreated":"2020-12-15T23:24:14+0000","dateStarted":"2020-12-15T23:25:30+0000","dateFinished":"2020-12-15T23:25:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12378"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1608074730817_587568853","id":"20201215-232530_2017775244","dateCreated":"2020-12-15T23:25:30+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:12379"}],"name":"prob1b","id":"2FTNXXU4Q","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}