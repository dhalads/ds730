{"paragraphs":[{"text":"//Problem 1a\n\n/*\nIn Oshkosh, which is more common: days where the temperature was\nreally cold (-10 or lower) at any point during the day or days where the\ntemperature was hot (95 or higher) at any point during the day?\n*/\n\n/*\nYear,Month,Day,TimeCST,TemperatureF,Dew PointF,Humidity,Sea Level PressureIn,VisibilityMPH,Wind Direction,Wind SpeedMPH,Gust SpeedMPH,PrecipitationIn,Events,Conditions,WindDirDegrees\n2000,1,1,12:53 AM,36,30.9,82,29.95,10,SSW,11.5,-,N/A,,Partly Cloudy,200\n2000,1,1,1:53 AM,37,30.9,79,29.96,10,SSW,6.9,-,N/A,,Partly Cloudy,210\n2000,1,1,2:53 AM,36,30,79,29.96,10,SW,5.8,-,N/A,,Partly Cloudy,220\n2000,1,1,3:53 AM,34,28.9,82,29.96,10,Calm,Calm,-,N/A,,Clear,0\n2000,1,1,4:53 AM,28.9,26.1,89,29.97,10,Calm,Calm,-,N/A,,Partly Cloudy,0\n*/\n\nval weather = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\",true).load(\"/user/maria_dev/final/Oshkosh/OshkoshWeather.csv\").select(\"Year\", \"Month\", \"Day\", \"TemperatureF\")\n\nweather.printSchema()\n\nval answerC = weather.filter($\"TemperatureF\" > -100).filter($\"TemperatureF\" <= -10).groupBy(\"Year\", \"Month\", \"Day\").agg(count(\"TemperatureF\").as(\"readingCount\"))\n\nanswerC.show(false)\n\n\nval answerH = weather.filter($\"TemperatureF\" >= 95).groupBy(\"Year\", \"Month\", \"Day\").agg(count(\"TemperatureF\").as(\"readingCount\"))\n\nanswerH.show(false)\n\nanswerC.count()\nanswerH.count()\n\n","user":"anonymous","dateUpdated":"2020-12-15T23:23:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"weather: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 2 more fields]\nroot\n |-- Year: integer (nullable = true)\n |-- Month: integer (nullable = true)\n |-- Day: integer (nullable = true)\n |-- TemperatureF: double (nullable = true)\n\nanswerC: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 2 more fields]\n+----+-----+---+------------+\n|Year|Month|Day|readingCount|\n+----+-----+---+------------+\n|2014|1    |3  |4           |\n|2014|1    |8  |1           |\n|2011|1    |23 |3           |\n|2011|2    |11 |1           |\n|2013|12   |24 |1           |\n|2004|1    |30 |7           |\n|2014|1    |28 |9           |\n|2015|1    |5  |3           |\n|2008|1    |20 |8           |\n|2004|1    |22 |4           |\n|2014|1    |27 |3           |\n|2009|1    |16 |10          |\n|2004|1    |29 |6           |\n|2004|2    |4  |2           |\n|2011|1    |21 |3           |\n|2004|1    |24 |1           |\n|2000|12   |25 |7           |\n|2006|2    |18 |9           |\n|2013|12   |30 |6           |\n|2004|12   |24 |6           |\n+----+-----+---+------------+\nonly showing top 20 rows\n\nanswerH: org.apache.spark.sql.DataFrame = [Year: int, Month: int ... 2 more fields]\n+----+-----+---+------------+\n|Year|Month|Day|readingCount|\n+----+-----+---+------------+\n|2012|7    |16 |5           |\n|2012|7    |17 |3           |\n|2002|7    |21 |4           |\n|2012|7    |23 |5           |\n|2011|7    |17 |1           |\n|2006|7    |15 |3           |\n|2012|7    |5  |7           |\n|2006|7    |31 |3           |\n|2011|7    |20 |2           |\n|2006|7    |17 |2           |\n|2012|7    |2  |2           |\n|2005|7    |17 |3           |\n|2011|6    |7  |4           |\n|2012|7    |25 |3           |\n+----+-----+---+------------+\n\nres104: Long = 35\nres105: Long = 14\n"}]},"apps":[],"jobName":"paragraph_1608074625523_-95466069","id":"20201215-232345_705102338","dateCreated":"2020-12-15T23:23:45+0000","dateStarted":"2020-12-15T23:23:59+0000","dateFinished":"2020-12-15T23:24:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11879"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1608074639312_2044522637","id":"20201215-232359_1825543653","dateCreated":"2020-12-15T23:23:59+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:11880"}],"name":"prob1a","id":"2FS9WZJA9","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}